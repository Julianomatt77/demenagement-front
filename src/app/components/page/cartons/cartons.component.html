<div class="w-full p-4 shadow sm:p-8" [class.blur-2xl]="showDeleteRoomConfirmModal">
  <div class="relative flex w-full flex-col items-center space-y-2.5 p-4">
    <h1 class="font-bold capitalize">Cartons</h1>
  </div>

  <div>Search  &/or filters</div>

  <span class="material-symbols-outlined cursor-pointer !text-4xl" title="Afficher/masquer les pièces enregistrées" (click)="toggleDisplayRooms()">{{displayRooms ? "expand_less" : "expand_more"}}</span>

  <div id="rooms_list" class="flex flex-col flex-wrap justify-center items-center gap-5 w-full px-4 pb-4 rounded-2xl" [class.hidden]="!displayRooms">
    <h2 class="pt-0">Pièces enregistrées</h2>

    <div class="flex flex-wrap justify-center items-center gap-4 w-full" >
      @for (room of rooms; track room.id) {
        <div class="relative flex justify-start gap-4 flex-wrap bg-background-200 dark:bg-background-200 w-58 rounded-xl p-4">

          @if (room.id === roomInEdit) {
            <app-room-form [room]="room" [isEdit]="true" (formSubmitted)="onRoomUpdated($event)"/>
          } @else {
            <p class="m-0">{{ room.name }}</p>
            <span class="material-symbols-outlined cursor-pointer mr-8" title="Modifier le nom" (click)="toggleEditRoomForm(room)">edit</span>
            <span class="material-symbols-outlined cursor-pointer absolute right-3 top-4 -translate-y-1/2 text-red-800 dark:text-red-500" title="supprimer la pièce" (click)="confirmDeleteRoom(room)">remove_circle</span>
          }
        </div>
      } @empty {
        <div><span>Vous n'avez aucune pièce enregistrée</span></div>
      }

      <div>
        @if (!showNewRoomForm) {
          <span class="material-symbols-outlined cursor-pointer !text-4xl" title="ajouter une pièce" (click)="toggleNewRoomForm()">add</span>
        } @else {
          <app-room-form (formSubmitted)="onRoomAdded($event)"/>
        }
      </div>

      @if (error) {
        <div class="text-red-500">
          {{ error }}
        </div>
      }
    </div>
  </div>

  <div id="boxes_list" class="flex flex-col flex-wrap justify-center items-center gap-5 w-full px-4 pb-4 rounded-2xl">
    <h2 class="">Liste des cartons</h2>

  </div>
</div>

@if(showDeleteRoomConfirmModal){
  <div method="dialog" class="absolute top-1/3 left-0 mx-5 md:left-1/3 bg-background-200 dark:bg-background-200 flex justify-center items-center z-10 rounded-xl p-4 w-11/12 md:w-2/5 md:min-w-[40%] md:max-w-[40%] shadow-sm">
    <div class="p-1 rounded-xl">
      <p>Voulez-vous vraiment supprimer la pièce "{{ roomToDelete?.name }}" ?</p>
      <p>Cette action est irréversible !</p>

      <div class="flex flex-wrap gap-8 justify-between items-center">
        <button (click)="deleteRoomConfirmed()" class="bg-red-800 hover:bg-red-600 dark:bg-red-800 dark:hover:bg-red-600" title="confirmer la suppression">Oui, supprimer</button>
        <button (click)="cancelDeleteRoom()" title="annuler la suppression">Annuler</button>
      </div>

    </div>
  </div>
}
